<!DOCTYPE html><html lang="en" class="no-js"><head><title>Adam Shaylor: Pollinate Customizer</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, shrink-to-fit=no"><meta name="keywords" content="designer, developer, software engineer, polymath, portland oregon"><meta name="description" content="Software designer and engineer. Portland, Oregon."><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="google" content="nositelinkssearchbox"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@adamshaylor"><meta name="twitter:title" content="Adam Shaylor"><meta name="twitter:description" content="Software designer and engineer. Portland, Oregon."><meta name="twitter:image" content="http://adamshaylor.com/favicon-180x180.png"><link rel="icon" type="image/png" href="/favicon-180x180.png" sizes="180x180"><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="stylesheet" href="/site.css"><script src="//cdnjs.cloudflare.com/ajax/libs/webfont/1.6.24/webfontloader.js"></script><script src="https://code.jquery.com/jquery-2.2.3.min.js"></script><script src="/site-prerender.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-63102701-1', 'auto');
	ga('send', 'pageview');</script></head><body class="colors-work-pollinate-customizer"><div id="smooth-state-container"><div class="page page-work-pollinate-customizer"><div class="grid"><header class="project-header"><a href="/" class="project-back-link"><span class="project-back-link-arrows"><svg viewBox="0 0 10 5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <polygon class="icon arrow-up" fill="#000000" transform="translate(5.235776, 2.341195) rotate(-90.000000) translate(-5.235776, -2.341195)" points="2.96343989 -0.109399546 5.44817067 2.3571951 2.96343989 4.7833088 2.98066055 6.87704466 7.50811197 2.3571951 2.96343989 -2.19465524"></polygon>
</svg>
<svg viewBox="0 0 10 5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <polygon class="icon arrow-up" fill="#000000" transform="translate(5.235776, 2.341195) rotate(-90.000000) translate(-5.235776, -2.341195)" points="2.96343989 -0.109399546 5.44817067 2.3571951 2.96343989 4.7833088 2.98066055 6.87704466 7.50811197 2.3571951 2.96343989 -2.19465524"></polygon>
</svg>
</span><span class="project-back-link-text">Adam Shaylor</span></a><section class="project-header-intro"><h1 class="project-header-intro-heading">Pollinate customizer platform</h1><ul class="project-header-intro-contributions"><li class="project-header-intro-contribution">technical prototype</li><li class="project-header-intro-contribution">front-end architecture</li><li class="project-header-intro-contribution">query language and parser</li></ul><p class="project-header-intro-copy"><a href="http://pollinate.com">Pollinate</a> has been building product selectors and customizers <a href="http://pollinate.com/custom-products/">for years</a>. During my tenure there, we worked with Benchmade, Wilson and Yakima. We saw an opportunity to draw on patterns we discovered working for them to create a platform from which all our clients could benefit by smaller scopes and faster development times. The resulting query language and front-end middleware I designed and built powers Pollinate’s customizer work today.</p></section></header><section class="project-section"><h2 class="project-section-heading">Custom query language</h2><section class="project-subsection"><div class="project-subsection-copy"><p>The most complex aspect of product customization is rendering. Given the rapidly changing landscape of HTML Canvas, WebGL and server-side rendering, we chose not to abstract any of the rendering. This left us open to vary our rendering strategy per project.</p><p>Instead, our first objective was to eliminate logic duplication between JavaScript in the browser and C# on the server. Most of the logic in a product customizer is responsible for modeling the relationships between product features and customizations. Database schemas composed of primitive values alone weren’t sufficient to model these rules.</p><p>We explored <a href="https://github.com/adamshaylor/complex-spa-architectures">hypermedia affordances and isomorphic JavaScript</a> but were ultimately dissatisfied with both options. Hypermedia affordances are not intended to impose complex logic on an API but rather to document <a href="https://en.wikipedia.org/wiki/HATEOAS">conceptual links between resource endpoints</a> with fairly straightforward CRUD operations that are typical in most HTTP APIs.</p></div><figure class="project-subsection-media"><div class="project-subsection-media-content"><iframe src="https://player.vimeo.com/video/95184526?title=0&amp;byline=0&amp;portrait=0" width="640" height="400" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div><figcaption class="project-subsection-media-caption">The Wilson uniform customizers like the one in this video use a custom <code>canvas</code> based renderer, whereas the customizer we built for Benchmade uses D3. Some of Pollinate’s latest customizers use WebGL.</figcaption></figure></section><section class="project-subsection"><div class="project-subsection-copy"><p>Isomorphic JavaScript would have required that we build most (if not all) of the back end with node. While our front-end team had some experience in node, it was limited to front-end build tools and stateless side projects. Our back-end team had much stronger experience with .NET. We also explored options for compiling C# into JavaScript but they weren’t mature enough at the time.</p><p>What eventually dictated our aproach to sharing logic was the way we structured the recipe data. After creating a prototype admin interface and concocting some mock recipes, I noticed that the recursive recipe data structure looked a lot like a DOM tree.</p><p>If we could write product feature queries with something akin to CSS selector strings, it would be both easy to learn, easy to maintain and efficient to transmit. Rules could be written and stored on the server in an SQL database and we could reason about them both there and in the browser.</p><p>I looked into <a href="http://jsonselect.org/">JSONSelect</a> but ruled it out for a couple of reasons. The first was a raft of unresolved issues and open pull reqests on Github. The second was the verbosity of the selectors. By designing a custom query language specifically for MTOC I was able to whittle down the average query string length by more than half.</p><p>After demonstrating examples of how such a query language might work to the team and establishing the conventions of the language, I used a <a href="https://github.com/adamshaylor/railroad-diagrams">railroad diagram generator</a> to formally document it and wrote JavaScript parser as its canonical implementation.</p></div><figure class="project-subsection-media project-subsection-media-wide"><div class="project-subsection-media-content"><img src="http://res.cloudinary.com/adam-shaylor/image/upload/v1466108297/portfolio-pollinate-interactive-query.gif"></div><figcaption class="project-subsection-media-caption">An example of Pollinate’s custom query language selecting features in two variations of the same product.</figcaption></figure></section></section><section class="project-section"><h2 class="project-section-heading">JavaScript middleware</h2><section class="project-subsection"><div class="project-subsection-copy"><p>Once the back-end and admin interface were built and the basic requirements for rendering were established, we needed to connect the dots between them into a JavaScript middleware library that could manage the relationships between rules, states and state history.</p><p>Concerned about a trend in the front-end industry of throwing away frameworks every couple of years, I chose our JavaScript dependencies carefully. I was also keen to avoid state mutations at the view layer. I built the middleware around event bus called <a href="https://github.com/postaljs/postal.js">Postal.js</a>, using it as a state container that receives requests to mutate via events and publishes the results of those mutations as events to subscribers.</p></div><figure class="project-subsection-media"><div class="project-subsection-media-content"><img src="http://res.cloudinary.com/adam-shaylor/image/upload/v1465966697/portfolio-pollinate-customizer-jacket.gif" class="large-pad-one-column medium-pad-one-column small-pad-one-gutter"></div><figcaption class="project-subsection-media-caption">A custom jacket from <a href="http://www.eddiebauer.com/custom/">Eddie Bauer’s line of custom clothing</a>, powered by Pollinate’s <a href="http://pollinate.com/custom-products/">customizer platform</a>.</figcaption></figure></section></section><section class="project-section"><h2 class="project-section-heading">Credits</h2><ul class="un-bullet"><li><a href="https://www.linkedin.com/in/bwaldron">Ben Waldron</a>, product owner</li><li><a href="https://twitter.com/davehog">Dave Becker</a>, back-end architecture</li><li><a href="https://www.linkedin.com/in/bill-shenk-29b52435">Bill Shenk</a>, admin interface</li><li><a href="http://hypothete.com/">Duncan Alexander</a>, visualization stakeholder</li></ul></section><footer class="project-footer"><a href="/" class="project-footer-back-link"><div class="project-footer-back-link-arrows"><svg viewBox="0 0 10 5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <polygon class="icon arrow-up" fill="#000000" transform="translate(5.235776, 2.341195) rotate(-90.000000) translate(-5.235776, -2.341195)" points="2.96343989 -0.109399546 5.44817067 2.3571951 2.96343989 4.7833088 2.98066055 6.87704466 7.50811197 2.3571951 2.96343989 -2.19465524"></polygon>
</svg>
<svg viewBox="0 0 10 5" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <polygon class="icon arrow-up" fill="#000000" transform="translate(5.235776, 2.341195) rotate(-90.000000) translate(-5.235776, -2.341195)" points="2.96343989 -0.109399546 5.44817067 2.3571951 2.96343989 4.7833088 2.98066055 6.87704466 7.50811197 2.3571951 2.96343989 -2.19465524"></polygon>
</svg>
</div></a></footer></div></div></div><script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/smoothState.js/0.7.2/jquery.smoothState.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenLite.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TimelineLite.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/plugins/CSSPlugin.min.js"></script><script>window.shaylor = window.shaylor || {};
window.shaylor.design ={
  "layout": {
    "gridAspectRatio": {
      "numerator": 16,
      "denominator": 9
    },
    "breakpoints": {
      "small": {
        "minWidthPx": null,
        "maxWidthPx": 959,
        "columnCount": 12,
        "columnToGutterRatio": 1.6,
        "rowCount": 24,
        "forceFitAspectRatio": false,
        "typeScale": {
          "unit": "rem",
          "ratio": 1.667,
          "bases": [
            1.8,
            2
          ]
        }
      },
      "medium": {
        "minWidthPx": 960,
        "maxWidthPx": 1439,
        "columnCount": 19,
        "columnToGutterRatio": 1.6,
        "rowCount": 54,
        "forceFitAspectRatio": true,
        "typeScale": {
          "unit": "rem",
          "ratio": 1.778,
          "bases": [
            1,
            1.2
          ]
        }
      },
      "large": {
        "minWidthPx": 1440,
        "maxWidthPx": null,
        "columnCount": 24,
        "columnToGutterRatio": 1.6,
        "rowCount": 58,
        "forceFitAspectRatio": true,
        "typeScale": {
          "unit": "rem",
          "ratio": 1.778,
          "bases": [
            1,
            1.2
          ]
        }
      }
    }
  },
  "pages": {
    "home": {
      "colors": {
        "lightPrimary": "#fbfbfd",
        "darkPrimary": "#121435",
        "darkSecondary": "#090916",
        "neutralPrimary": "#9699b9",
        "strongPrimary": "#dc347f",
        "strongSecondary": "#5915f6"
      }
    },
    "work-whispbar": {
      "colors": {
        "lightPrimary": "#ffffff",
        "darkPrimary": "#020202",
        "darkSecondary": "#1c1c1c",
        "neutralPrimary": "#9f9e9e",
        "strongPrimary": "#6390c9",
        "strongSecondary": "#ab7eb7"
      }
    },
    "work-polymath-interviews": {
      "colors": {
        "lightPrimary": "#ffeeba",
        "darkPrimary": "#7e5233",
        "darkSecondary": "#5e7a87",
        "neutralPrimary": "#5e7a87",
        "strongPrimary": "#f45d00",
        "strongSecondary": "#e2993a"
      }
    },
    "work-pollinate-customizer": {
      "colors": {
        "lightPrimary": "#ebf7f9",
        "darkPrimary": "#000000",
        "darkSecondary": "#3c3b3a",
        "neutralPrimary": "#079fac",
        "strongPrimary": "#ec1200",
        "strongSecondary": "#079fac"
      }
    },
    "work-sams-header": {
      "colors": {
        "lightPrimary": "#ffffff",
        "darkPrimary": "#222222",
        "darkSecondary": "#424242",
        "neutralPrimary": "#9b9b9b",
        "strongPrimary": "#1977d3",
        "strongSecondary": "#4ca90c"
      }
    }
  },
  "animationDefaults": {
    "timingFunctions": {
      "css": "cubic-bezier(0.62, 0.28, 0.23, 0.99)",
      "gsap": ["Power1", "easeInOut"]
    },
    "durationsInSeconds": {
      "shorter": 0.1,
      "short": 0.2,
      "mediumShort": 0.6,
      "medium": 0.8,
      "mediumLong": 1.0,
      "long": 2.0
    }
  },
  "defaultShadow": "rgba(0, 0, 0, 0.08) 0.5rem 0.5rem 0"
}
;</script><script src="/shared/querify-breakpoint.js"></script><script src="/site-postrender.js"></script></body></html>